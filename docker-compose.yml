version: '3.8'
services:
  db:
    image: ankane/pgvector:latest
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
      POSTGRES_DB: tomo
    ports:
      - "5432:5432"
    volumes:
      - db-data:/var/lib/postgresql/data
  computer-use-mcp:
    build:
      context: .
      dockerfile: docker/computer-use-mcp/Dockerfile
    environment:
      DISPLAY: ${DISPLAY}
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:ro
    network_mode: host
    stdin_open: true
    tty: true
  ur3_sim:
    build:
      context: ./ur3_test
      dockerfile: docker/Dockerfile
    image: ur3_pick_place:jazzy
    container_name: ur3_sim_test
    network_mode: host
    ipc: host
    environment:
      - DISPLAY=${DISPLAY}
      - QT_X11_NO_MITSHM=1
      - ROS_DOMAIN_ID=${ROS_DOMAIN_ID:-0}
      - GZ_SIM_RESOURCE_PATH=/ws/install/ur_description/share:/ws/install/robotiq_2f_85_gripper_visualization/share:/ws/install
      - IGN_GAZEBO_RESOURCE_PATH=/ws/install/ur_description/share:/ws/install/robotiq_2f_85_gripper_visualization/share:/ws/install
    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
      - /dev/dri:/dev/dri
    stdin_open: true
    tty: true

volumes:
  db-data:
